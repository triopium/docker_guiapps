# TODO: ban root account logging
FROM ubuntu:latest as base

# ADD APPS
RUN apt-get -y update \
	&& DEBIAN_FRONTEND=noninteractive \
	apt-get -y  \
	--no-install-recommends \
	install \
	ca-certificates \
	xauth \
	emacs \
	vifm \
	git-all \
	vim

# USER CREATE
FROM base as userspec
ARG MY_USER
ARG MY_GROUP
ARG MY_UID
ARG MY_GID

RUN groupadd -g $MY_GID $MY_USER
RUN adduser --uid $MY_UID --gid $MY_GID $MY_USER

WORKDIR "/home/$MY_USER"
ADD  ./emacs.d/ ./.emacs.d/

RUN echo chown -R $MY_USER:$MY_GROUP ./.emacs.d/

# MAKE DEFAULT USER
USER  $MY_USER
